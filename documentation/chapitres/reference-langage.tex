%!TEX encoding = UTF-8 Unicode
%!TEX root = ../piccolo.tex

\cleardoublepage

\chapter{Description du langage Piccolo}

%--- Pour supprimer tout en-tête et pied de page sur la 1re page d'un chapitre
\thispagestyle{empty}


\section{Éléments lexicaux}

\subsection{Commentaires}

Un commentaire commence par un caractère dièse « \texttt{\#} », et s’étend jusqu’à la fin de la ligne courante.

\subsection{Délimiteurs}

Piccolo définit les délimiteurs suivants :\\


\texttt{
  \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    *  & *+ & ,  & != & <= & >= & *- & +* & ; & :  & == & < & > & [ & ] & . & ! \\
    \hline
    \& & |  & \{ & \} & (  & )  & /  & - & + & \^{} & <{}< & >{}> & \~{} & @ & \% & = & \\
    \hline
  \end{tabular}
}

\subsection{Séparateurs}

Tout caractère dont le code ASCII est compris entre \texttt{0x01} et \texttt{0x20} est considéré comme un séparateur (ceci inclut donc la tabulation horizontale \texttt{HT} (\texttt{0x09}), le passage à la ligne \texttt{LF} (\texttt{0x0A}), le retour-chariot \texttt{CR} (\texttt{0x0D}), et l’espace (\texttt{0x20}).

\subsection{Identificateurs}
Un identificateur commence par une lettre (minuscule ou majuscule), qui est suivie par zéro, un ou plusieurs lettres (minuscules ou majuscules), chiffres décimaux, caractères « \_ ».

La casse est significative pour les identificateurs.

\subsection{Mots réservés}
\index{Mots réservés}

Certains identificateurs sont réservés. La casse n’est pas significative pour les mots réservés, c’est à dire que les mots réservés peuvent être écrits indifféremment avec des lettres minuscules ou majuscules.


~\\
Mots réservés correspondant aux éléments du langage :\\

\newcommand\keyWordLanguage[1]{\textcolor{blue}{\bf#1}}

\begin{tabular}{|l|l|l|l|l|l|}
  \hline
   \keyWordLanguage{bank} & \keyWordLanguage{banksave} & \keyWordLanguage{banksel} & \keyWordLanguage{baseline} & \keyWordLanguage{bootloader} \\
  \hline
    \keyWordLanguage{byte} & \keyWordLanguage{computed} & \keyWordLanguage{configuration} & \keyWordLanguage{const} & \keyWordLanguage{contextsave} \\
  \hline
   \keyWordLanguage{data} & \keyWordLanguage{do} & \keyWordLanguage{end} & \keyWordLanguage{else} & \keyWordLanguage{elsif} \\
  \hline
   \keyWordLanguage{ensures} & \keyWordLanguage{fast} & \keyWordLanguage{forever} & \keyWordLanguage{if} & \keyWordLanguage{implements}   \\
  \hline
    \keyWordLanguage{include} & \keyWordLanguage{interrupt} & \keyWordLanguage{mark} & \keyWordLanguage{midrange} & \keyWordLanguage{nobank} \\
  \hline
    \keyWordLanguage{noreturn} & \keyWordLanguage{page} & \keyWordLanguage{pic18} & \keyWordLanguage{preserved} & \keyWordLanguage{ram} \\
  \hline
    \keyWordLanguage{requires} & \keyWordLanguage{rom} & \keyWordLanguage{routine} & \keyWordLanguage{uses} & \keyWordLanguage{w} \\
  \hline
    \keyWordLanguage{while} & & & & \\
  \hline
\end{tabular}

~\\
Dans tout ce document, ces mots réservés sont écrits en minuscule, gras et en bleu.

~\\
Mots réservés correspondant à des instructions exécutables :\\

\newcommand\keyWordInstruction[1]{\textcolor{brown}{\bf#1}}

\begin{tabular}{|l|l|l|l|l|l|l|}
  \hline
    \keyWordInstruction{addlw} & \keyWordInstruction{addwf} & \keyWordInstruction{addwfc} & \keyWordInstruction{andlw} & \keyWordInstruction{andwf} & \keyWordInstruction{bc} & \keyWordInstruction{bcf} \\
  \hline
    \keyWordInstruction{bn} & \keyWordInstruction{bnc} & \keyWordInstruction{bnn} & \keyWordInstruction{bov} & \keyWordInstruction{bnov} & \keyWordInstruction{bnz} & \keyWordInstruction{bsf} \\
  \hline
    \keyWordInstruction{bra} & \keyWordInstruction{btg} & \keyWordInstruction{bz} & \keyWordInstruction{call} & \keyWordInstruction{clrf} & \keyWordInstruction{clrw} & \keyWordInstruction{clrwdt} \\
  \hline
    \keyWordInstruction{comf} & \keyWordInstruction{daw} & \keyWordInstruction{decf} & \keyWordInstruction{incf} & \keyWordInstruction{iorlw} & \keyWordInstruction{iorwf} & \keyWordInstruction{goto} \\
  \hline
    \keyWordInstruction{jsr} & \keyWordInstruction{jump} & \keyWordInstruction{lfsr} & \keyWordInstruction{ldataptr} & \keyWordInstruction{ltblptr} & \keyWordInstruction{mnop} & \keyWordInstruction{movf} \\
  \hline
    \keyWordInstruction{movff} & \keyWordInstruction{movlw} & \keyWordInstruction{movwf} & \keyWordInstruction{mullw} & \keyWordInstruction{mulwf} & \keyWordInstruction{negf} & \keyWordInstruction{nop} \\
  \hline
    \keyWordInstruction{pop} & \keyWordInstruction{option} & \keyWordInstruction{push} & \keyWordInstruction{rcall} & \keyWordInstruction{reset} & \keyWordInstruction{retlw} & \keyWordInstruction{rlcf} \\
  \hline
    \keyWordInstruction{rlf} & \keyWordInstruction{rlncf} & \keyWordInstruction{rrcf} & \keyWordInstruction{rrf} & \keyWordInstruction{rrncf} & \keyWordInstruction{setf} & \keyWordInstruction{sleep} \\
  \hline
    \keyWordInstruction{subfwb} & \keyWordInstruction{sublw} & \keyWordInstruction{subwf} & \keyWordInstruction{subwfb} & \keyWordInstruction{swapf} & \keyWordInstruction{tblrd} & \keyWordInstruction{tblwt}\\
  \hline
    \keyWordInstruction{tris}\keyWordInstruction{xorlw} & \keyWordInstruction{xorwf} & & & & & \\
  \hline
\end{tabular}

Dans tout ce document, ces mots réservés sont écrits en minuscule, gras et en marron. Les instructions assembleur correspondantes sont écrites en majuscules.


\subsection{Constante chaîne de caractères}

Comme en C, les chaînes de caractères sont délimitées par des caractères « \texttt{\textquotedbl} ».  Les séquences d’échappement suivantes sont acceptées : « \texttt{\textbackslash f} », « \texttt{\textbackslash n} », « \texttt{\textbackslash r} », « \texttt{\textbackslash v} », « \texttt{\textbackslash\textbackslash} », « \texttt{\textbackslash"} », « \texttt{\textbackslash\textquotesingle} », « \texttt{\textbackslash 0} ».

\subsection{Constante caractère}

Comme en C, les caractères sont délimités par des caractères « \texttt{\textquotesingle} ».  Les séquences d’échappement suivantes sont acceptées : « \texttt{\textbackslash f} », « \texttt{\textbackslash n} », « \texttt{\textbackslash r} », « \texttt{\textbackslash v} », « \texttt{\textbackslash\textbackslash} », « \texttt{\textbackslash\textquotesingle} », « \texttt{\textbackslash 0} ».

\subsection{Constante entière}

Vous pouvez écrire les constantes entières en décimal, en hexadécimal ou en binaire. 

Une constante entière décimale commence par un chiffre décimal, et est suivie par zéro, un ou plusieurs chiffres décimaux, ou caractères « \_ ».

Un chiffre hexadécimal est soit un chiffre décimal, soit une lettre entre « a » et « f », écrite indifféremment en minuscule ou en majuscule. Une constante hexadécimale commence par la séquence « 0x », et est suivie par un ou plusieurs chiffres hexadécimal, ou caractères « \_ ».

Une constante entière binaire commence par la séquence « 0b » suivie par un ou plusieurs chiffres binaires, « 0 » ou « 1 », ou le caractère « \_ ».

Dans une constante entière, écrite en décimal ou en hexadécimal, le caractère « \_ » peut servir de séparateur ; on peut ainsi écrire indifféremment : 100, 1\_00, 1\_0\_0, 1\_\_\_00, …

Attention :
contrairement au C, un nombre qui commence par un zéro est un nombre écrit en décimal ;
contrairement à l’assembleur PIC, le préfixe « 0x » est indispensable pour écrire un nombre en hexadécimal.

\subsection{Format}

Le format est libre, la fin de ligne n’est pas significative (sauf pour les commentaires, qui commencent par un caractère dièse « \# », et s’étendent jusqu’à la fin de la ligne courante). Le compilateur accepte de manière indifférente que les fins de ligne soient codés par un caractère LF (0x0A), un caractère CR (0x0D), ou par la séquence CRLF (0x0D, 0x0A).

