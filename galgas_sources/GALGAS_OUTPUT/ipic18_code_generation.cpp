//---------------------------------------------------------------------------*
//                                                                           *
//                    File 'ipic18_code_generation.cpp'                      *
//                        Generated by version 2.5.0                         *
//                      august 5th, 2013, at 11h28'58"                       *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "ipic18_code_generation.h"
#include "galgas2/C_Compiler.h"
#include "galgas2/C_galgas_io.h"
#include "galgas2/C_galgas_CLI_Options.h"
#include "utilities/C_PrologueEpilogue.h"

//---------------------------------------------------------------------------*


//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "ipic18_code_generation.gSemantics", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif

//---------------------------------------------------------------------------*
//                                                                           *
//                      Routine 'generateLineWithCode'                       *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_generateLineWithCode (const GALGAS_uint constinArgument0,
                                   const GALGAS_codeList constinArgument1,
                                   const GALGAS_stringlist constinArgument2,
                                   GALGAS_string & ioArgument3,
                                   C_Compiler * inCompiler
                                   COMMA_LOCATION_ARGS) ;

//---------------------------------------------------------------------------*
//                                                                           *
//                      Routine 'generateLineWithCode'                       *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_generateLineWithCode (const GALGAS_uint constinArgument_inAddress,
                                   const GALGAS_codeList constinArgument_inCode,
                                   const GALGAS_stringlist constinArgument_inIpicText,
                                   GALGAS_string & ioArgument_ioListFileContents,
                                   C_Compiler * inCompiler
                                   COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_stringlist var_ipicText = constinArgument_inIpicText ;
  if (constinArgument_inCode.reader_length (SOURCE_FILE_AT_LINE (36)).add_operation (GALGAS_uint ((PMUInt32) 1U), inCompiler COMMA_SOURCE_FILE_AT_LINE (36)).isValid ()) {
    PMUInt32 variant_1265 = constinArgument_inCode.reader_length (SOURCE_FILE_AT_LINE (36)).add_operation (GALGAS_uint ((PMUInt32) 1U), inCompiler COMMA_SOURCE_FILE_AT_LINE (36)).uintValue () ;
    bool loop_1265 = true ;
    while (loop_1265) {
      loop_1265 = GALGAS_bool (kIsStrictInf, var_ipicText.reader_length (SOURCE_FILE_AT_LINE (37)).objectCompare (constinArgument_inCode.reader_length (SOURCE_FILE_AT_LINE (37)))).isValid () ;
      if (loop_1265) {
        loop_1265 = GALGAS_bool (kIsStrictInf, var_ipicText.reader_length (SOURCE_FILE_AT_LINE (37)).objectCompare (constinArgument_inCode.reader_length (SOURCE_FILE_AT_LINE (37)))).boolValue () ;
      }
      if (loop_1265 && (0 == variant_1265)) {
        loop_1265 = false ;
        inCompiler->loopRunTimeVariantError (SOURCE_FILE_AT_LINE (36)) ;
      }
      if (loop_1265) {
        variant_1265 -- ;
        var_ipicText.addAssign_operation (GALGAS_string::makeEmptyString () COMMA_SOURCE_FILE_AT_LINE (38)) ;
      }
    }
  }
  GALGAS_uint var_address = constinArgument_inAddress ;
  cEnumerator_stringlist enumerator_1423 (var_ipicText, kEnumeration_up) ;
  cEnumerator_codeList enumerator_1433 (constinArgument_inCode, kEnumeration_up) ;
  while (enumerator_1423.hasCurrentObject () && enumerator_1433.hasCurrentObject ()) {
    ioArgument_ioListFileContents.dotAssign_operation (categoryReader_x_36_string (var_address, inCompiler COMMA_SOURCE_FILE_AT_LINE (43)) COMMA_SOURCE_FILE_AT_LINE (43)) ;
    var_address = var_address.add_operation (GALGAS_uint ((PMUInt32) 2U).multiply_operation (enumerator_1433.current_mBinaryCode (HERE).reader_length (SOURCE_FILE_AT_LINE (44)), inCompiler COMMA_SOURCE_FILE_AT_LINE (44)), inCompiler COMMA_SOURCE_FILE_AT_LINE (44)) ;
    GALGAS_string var_s = GALGAS_string (" ") ;
    cEnumerator_uintlist enumerator_1590 (enumerator_1433.current_mBinaryCode (HERE), kEnumeration_up) ;
    while (enumerator_1590.hasCurrentObject ()) {
      var_s.dotAssign_operation (GALGAS_string (" ").operator_concat (categoryReader_x_34_string (enumerator_1590.current_mValue (HERE), inCompiler COMMA_SOURCE_FILE_AT_LINE (47)) COMMA_SOURCE_FILE_AT_LINE (47)) COMMA_SOURCE_FILE_AT_LINE (47)) ;
      enumerator_1590.gotoNextObject () ;
    }
    ioArgument_ioListFileContents.dotAssign_operation (var_s.reader_stringByRightPadding (GALGAS_uint ((PMUInt32) 13U), GALGAS_char (TO_UNICODE (32)) COMMA_SOURCE_FILE_AT_LINE (49)) COMMA_SOURCE_FILE_AT_LINE (49)) ;
    ioArgument_ioListFileContents.dotAssign_operation (enumerator_1433.current_mAssemblyCode (HERE).reader_stringByRightPadding (GALGAS_uint ((PMUInt32) 40U), GALGAS_char (TO_UNICODE (32)) COMMA_SOURCE_FILE_AT_LINE (50)) COMMA_SOURCE_FILE_AT_LINE (50)) ;
    ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string (" ") COMMA_SOURCE_FILE_AT_LINE (51)) ;
    ioArgument_ioListFileContents.dotAssign_operation (enumerator_1423.current_mValue (HERE) COMMA_SOURCE_FILE_AT_LINE (52)) ;
    ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string ("\n") COMMA_SOURCE_FILE_AT_LINE (53)) ;
    enumerator_1423.gotoNextObject () ;
    enumerator_1433.gotoNextObject () ;
  }
  cEnumerator_stringlist enumerator_2025 (var_ipicText.reader_subListFromIndex (constinArgument_inCode.reader_length (SOURCE_FILE_AT_LINE (57)), inCompiler COMMA_SOURCE_FILE_AT_LINE (57)), kEnumeration_up) ;
  while (enumerator_2025.hasCurrentObject ()) {
    ioArgument_ioListFileContents.dotAssign_operation (categoryReader_x_36_string (var_address, inCompiler COMMA_SOURCE_FILE_AT_LINE (58)) COMMA_SOURCE_FILE_AT_LINE (58)) ;
    ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string::makeEmptyString ().reader_stringByRightPadding (GALGAS_uint ((PMUInt32) 54U), GALGAS_char (TO_UNICODE (32)) COMMA_SOURCE_FILE_AT_LINE (59)) COMMA_SOURCE_FILE_AT_LINE (59)) ;
    ioArgument_ioListFileContents.dotAssign_operation (enumerator_2025.current_mValue (HERE) COMMA_SOURCE_FILE_AT_LINE (60)) ;
    ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string ("\n") COMMA_SOURCE_FILE_AT_LINE (61)) ;
    enumerator_2025.gotoNextObject () ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                       Routine 'ipic18GenerateCode'                        *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_ipic_31__38_GenerateCode (const GALGAS_string /* constinArgument_inSourceFileName */,
                                       GALGAS_string & ioArgument_ioListFileContents,
                                       const GALGAS_ipic_31__38_BlockList constinArgument_inGeneratedBlockList,
                                       C_Compiler * inCompiler
                                       COMMA_UNUSED_LOCATION_ARGS) {
  ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string::makeEmptyString ().reader_stringByLeftAndRightPadding (GALGAS_uint ((PMUInt32) 79U), GALGAS_char (TO_UNICODE (42)) COMMA_SOURCE_FILE_AT_LINE (124)).operator_concat (GALGAS_string ("\n") COMMA_SOURCE_FILE_AT_LINE (124)) COMMA_SOURCE_FILE_AT_LINE (124)) ;
  ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string ("*").operator_concat (GALGAS_string ("CODE GENERATION").reader_stringByLeftAndRightPadding (GALGAS_uint ((PMUInt32) 77U), GALGAS_char (TO_UNICODE (32)) COMMA_SOURCE_FILE_AT_LINE (125)) COMMA_SOURCE_FILE_AT_LINE (125)).operator_concat (GALGAS_string ("*\n") COMMA_SOURCE_FILE_AT_LINE (125)) COMMA_SOURCE_FILE_AT_LINE (125)) ;
  ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string::makeEmptyString ().reader_stringByLeftAndRightPadding (GALGAS_uint ((PMUInt32) 79U), GALGAS_char (TO_UNICODE (42)) COMMA_SOURCE_FILE_AT_LINE (126)).operator_concat (GALGAS_string ("\n"
    "\n") COMMA_SOURCE_FILE_AT_LINE (126)) COMMA_SOURCE_FILE_AT_LINE (126)) ;
  GALGAS_symbolTableForRelativesResolution var_symbolTable ;
  {
  routine_computeLabelAbsoluteAddressMap (constinArgument_inGeneratedBlockList, var_symbolTable, inCompiler COMMA_SOURCE_FILE_AT_LINE (128)) ;
  }
  GALGAS_uint var_blockStartAddress = GALGAS_uint ((PMUInt32) 0U) ;
  cEnumerator_ipic_31__38_BlockList enumerator_4501 (constinArgument_inGeneratedBlockList, kEnumeration_up) ;
  GALGAS_uint index_4495 ((PMUInt32) 0) ;
  while (enumerator_4501.hasCurrentObject ()) {
    GALGAS_string var_nextBlockLabel ;
    const enumGalgasBool test_0 = GALGAS_bool (kIsStrictInf, index_4495.add_operation (GALGAS_uint ((PMUInt32) 1U), inCompiler COMMA_SOURCE_FILE_AT_LINE (136)).objectCompare (constinArgument_inGeneratedBlockList.reader_length (SOURCE_FILE_AT_LINE (136)))).boolEnum () ;
    if (kBoolTrue == test_0) {
      var_nextBlockLabel = constinArgument_inGeneratedBlockList.reader_mBlockAtIndex (index_4495.add_operation (GALGAS_uint ((PMUInt32) 1U), inCompiler COMMA_SOURCE_FILE_AT_LINE (137)), inCompiler COMMA_SOURCE_FILE_AT_LINE (137)).mAttribute_mLabel.mAttribute_string ;
    }else if (kBoolFalse == test_0) {
      var_nextBlockLabel = GALGAS_string::makeEmptyString () ;
    }
    const enumGalgasBool test_1 = GALGAS_bool (kIsNotEqual, enumerator_4501.current_mBlock (HERE).mAttribute_mStartAddress.objectCompare (GALGAS_uint::constructor_max (SOURCE_FILE_AT_LINE (141)))).boolEnum () ;
    if (kBoolTrue == test_1) {
      var_blockStartAddress = enumerator_4501.current_mBlock (HERE).mAttribute_mStartAddress ;
    }
    categoryMethod_generateCode (enumerator_4501.current_mBlock (HERE), var_symbolTable, constinArgument_inGeneratedBlockList, var_blockStartAddress, var_nextBlockLabel, ioArgument_ioListFileContents, inCompiler COMMA_SOURCE_FILE_AT_LINE (144)) ;
    GALGAS_uint var_blockSize = categoryReader_blockSize (enumerator_4501.current_mBlock (HERE), var_nextBlockLabel, inCompiler COMMA_SOURCE_FILE_AT_LINE (145)) ;
    var_blockStartAddress = var_blockStartAddress.add_operation (var_blockSize, inCompiler COMMA_SOURCE_FILE_AT_LINE (146)) ;
    enumerator_4501.gotoNextObject () ;
    index_4495.increment_operation (inCompiler COMMA_SOURCE_FILE_AT_LINE (134)) ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                     Category Reader '@uint x4string'                      *
//                                                                           *
//---------------------------------------------------------------------------*

GALGAS_string categoryReader_x_34_string (const GALGAS_uint & inObject,
                                          C_Compiler * inCompiler
                                          COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_string result_outResult ; // Returned variable
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_0 = inObject ;
  result_outResult = temp_0.divide_operation (GALGAS_uint ((PMUInt32) 4096U), inCompiler COMMA_SOURCE_FILE_AT_LINE (9)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (9)).reader_xString (SOURCE_FILE_AT_LINE (9)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_1 = inObject ;
  result_outResult.dotAssign_operation (temp_1.divide_operation (GALGAS_uint ((PMUInt32) 256U), inCompiler COMMA_SOURCE_FILE_AT_LINE (10)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (10)).reader_xString (SOURCE_FILE_AT_LINE (10)) COMMA_SOURCE_FILE_AT_LINE (10)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_2 = inObject ;
  result_outResult.dotAssign_operation (temp_2.divide_operation (GALGAS_uint ((PMUInt32) 16U), inCompiler COMMA_SOURCE_FILE_AT_LINE (11)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (11)).reader_xString (SOURCE_FILE_AT_LINE (11)) COMMA_SOURCE_FILE_AT_LINE (11)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_3 = inObject ;
  result_outResult.dotAssign_operation (temp_3.operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (12)).reader_xString (SOURCE_FILE_AT_LINE (12)) COMMA_SOURCE_FILE_AT_LINE (12)) ;
//---
  return result_outResult ;
}




//---------------------------------------------------------------------------*
//                                                                           *
//                     Category Reader '@uint x6string'                      *
//                                                                           *
//---------------------------------------------------------------------------*

GALGAS_string categoryReader_x_36_string (const GALGAS_uint & inObject,
                                          C_Compiler * inCompiler
                                          COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_string result_outResult ; // Returned variable
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_0 = inObject ;
  result_outResult = temp_0.divide_operation (GALGAS_uint ((PMUInt32) 1048576U), inCompiler COMMA_SOURCE_FILE_AT_LINE (18)).reader_xString (SOURCE_FILE_AT_LINE (18)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_1 = inObject ;
  result_outResult = temp_1.divide_operation (GALGAS_uint ((PMUInt32) 65536U), inCompiler COMMA_SOURCE_FILE_AT_LINE (19)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (19)).reader_xString (SOURCE_FILE_AT_LINE (19)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_2 = inObject ;
  result_outResult.dotAssign_operation (temp_2.divide_operation (GALGAS_uint ((PMUInt32) 4096U), inCompiler COMMA_SOURCE_FILE_AT_LINE (20)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (20)).reader_xString (SOURCE_FILE_AT_LINE (20)) COMMA_SOURCE_FILE_AT_LINE (20)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_3 = inObject ;
  result_outResult.dotAssign_operation (temp_3.divide_operation (GALGAS_uint ((PMUInt32) 256U), inCompiler COMMA_SOURCE_FILE_AT_LINE (21)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (21)).reader_xString (SOURCE_FILE_AT_LINE (21)) COMMA_SOURCE_FILE_AT_LINE (21)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_4 = inObject ;
  result_outResult.dotAssign_operation (temp_4.divide_operation (GALGAS_uint ((PMUInt32) 16U), inCompiler COMMA_SOURCE_FILE_AT_LINE (22)).operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (22)).reader_xString (SOURCE_FILE_AT_LINE (22)) COMMA_SOURCE_FILE_AT_LINE (22)) ;
  //--- @selfCopyInExpressionForGeneration
  const GALGAS_uint temp_5 = inObject ;
  result_outResult.dotAssign_operation (temp_5.operator_and (GALGAS_uint ((PMUInt32) 15U) COMMA_SOURCE_FILE_AT_LINE (23)).reader_xString (SOURCE_FILE_AT_LINE (23)) COMMA_SOURCE_FILE_AT_LINE (23)) ;
//---
  return result_outResult ;
}




//---------------------------------------------------------------------------*
//                                                                           *
//                Category method '@ipic18Block generateCode'                *
//                                                                           *
//---------------------------------------------------------------------------*

void categoryMethod_generateCode (const GALGAS_ipic_31__38_Block inObject,
                                  const GALGAS_symbolTableForRelativesResolution constinArgument_inSymbolTable,
                                  const GALGAS_ipic_31__38_BlockList /* constinArgument_inGeneratedBlockList */,
                                  const GALGAS_uint constinArgument_inBlockAddress,
                                  const GALGAS_string /* constinArgument_inNextBlockLabel */,
                                  GALGAS_string & ioArgument_ioListFileContents,
                                  C_Compiler * inCompiler
                                  COMMA_UNUSED_LOCATION_ARGS) {
  ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string ("Addr.  Code       Assembly                                 Intermediate Representation\n") COMMA_SOURCE_FILE_AT_LINE (74)) ;
  const enumGalgasBool test_0 = GALGAS_bool (kIsEqual, inObject.mAttribute_mStartAddress.objectCompare (GALGAS_uint::constructor_max (SOURCE_FILE_AT_LINE (75)))).boolEnum () ;
  if (kBoolTrue == test_0) {
    {
    routine_generateLineWithCode (constinArgument_inBlockAddress, GALGAS_codeList::constructor_listWithValue (inObject.mAttribute_mLabel.mAttribute_string.operator_concat (GALGAS_string (":") COMMA_SOURCE_FILE_AT_LINE (78)), GALGAS_uintlist::constructor_emptyList (SOURCE_FILE_AT_LINE (78)) COMMA_SOURCE_FILE_AT_LINE (78)), GALGAS_stringlist::constructor_listWithValue (GALGAS_string ("LABEL ").operator_concat (inObject.mAttribute_mLabel.reader_string (SOURCE_FILE_AT_LINE (79)) COMMA_SOURCE_FILE_AT_LINE (79)) COMMA_SOURCE_FILE_AT_LINE (79)), ioArgument_ioListFileContents, inCompiler COMMA_SOURCE_FILE_AT_LINE (76)) ;
    }
  }else if (kBoolFalse == test_0) {
    GALGAS_codeList var_cd = GALGAS_codeList::constructor_emptyList (SOURCE_FILE_AT_LINE (83)) ;
    var_cd.addAssign_operation (GALGAS_string ("ORG ").operator_concat (constinArgument_inBlockAddress.reader_hexString (SOURCE_FILE_AT_LINE (84)) COMMA_SOURCE_FILE_AT_LINE (84)), GALGAS_uintlist::constructor_emptyList (SOURCE_FILE_AT_LINE (84)) COMMA_SOURCE_FILE_AT_LINE (84)) ;
    var_cd.addAssign_operation (inObject.mAttribute_mLabel.mAttribute_string.operator_concat (GALGAS_string (":") COMMA_SOURCE_FILE_AT_LINE (85)), GALGAS_uintlist::constructor_emptyList (SOURCE_FILE_AT_LINE (85)) COMMA_SOURCE_FILE_AT_LINE (85)) ;
    {
    routine_generateLineWithCode (constinArgument_inBlockAddress, var_cd, GALGAS_stringlist::constructor_listWithValue (GALGAS_string ("LABEL ").operator_concat (inObject.mAttribute_mLabel.reader_string (SOURCE_FILE_AT_LINE (89)) COMMA_SOURCE_FILE_AT_LINE (89)).operator_concat (GALGAS_string (", ORG ") COMMA_SOURCE_FILE_AT_LINE (89)).operator_concat (constinArgument_inBlockAddress.reader_hexString (SOURCE_FILE_AT_LINE (89)) COMMA_SOURCE_FILE_AT_LINE (89)) COMMA_SOURCE_FILE_AT_LINE (89)), ioArgument_ioListFileContents, inCompiler COMMA_SOURCE_FILE_AT_LINE (86)) ;
    }
  }
  GALGAS_uint var_address = constinArgument_inBlockAddress ;
  cEnumerator_ipic_31__38_SequentialInstructionList enumerator_3379 (inObject.mAttribute_mInstructionList, kEnumeration_up) ;
  while (enumerator_3379.hasCurrentObject ()) {
    GALGAS_codeList var_inCode ;
    callCategoryMethod_generateCode ((const cPtr_ipic_31__38_SequentialInstruction *) enumerator_3379.current_mInstruction (HERE).ptr (), var_address, constinArgument_inSymbolTable, var_inCode, inCompiler COMMA_SOURCE_FILE_AT_LINE (96)) ;
    GALGAS_stringlist var_ipicText = callCategoryReader_instructionDisplay ((const cPtr_ipic_31__38_SequentialInstruction *) enumerator_3379.current_mInstruction (HERE).ptr (), inCompiler COMMA_SOURCE_FILE_AT_LINE (101)) ;
    {
    routine_generateLineWithCode (var_address, var_inCode, var_ipicText, ioArgument_ioListFileContents, inCompiler COMMA_SOURCE_FILE_AT_LINE (102)) ;
    }
    var_address = var_address.add_operation (callCategoryReader_instructionSize ((const cPtr_ipic_31__38_SequentialInstruction *) enumerator_3379.current_mInstruction (HERE).ptr (), inCompiler COMMA_SOURCE_FILE_AT_LINE (108)), inCompiler COMMA_SOURCE_FILE_AT_LINE (108)) ;
    enumerator_3379.gotoNextObject () ;
  }
  ioArgument_ioListFileContents.dotAssign_operation (GALGAS_string ("\n") COMMA_SOURCE_FILE_AT_LINE (114)) ;
}


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


